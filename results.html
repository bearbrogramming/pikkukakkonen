<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Bro-Timeâ„¢</title>
    <script src="/lib/jquery/jquery-1.9.1.js"></script>
    <script src="/lib/jquery/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="/lib/bootstrap/bootstrap.min.js"></script>
    <script src="/lib/jquery.tablesorter.min.js"></script>

    <link rel="stylesheet" href="/lib/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="/lib/bootstrap/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/lib/jquery/jquery-ui-1.10.3.custom.min.css">

    <link rel="stylesheet" href="style.css">

</head>
<body>

<div class="container">
    <div id="logo">
        Bro-Time<sup>TM</sup>
    </div>
    <div id="selection">
        <div class="col-xs-9">
            <h2>Results</h2>
            <table id="results">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th class="option yes"></th>
                        <th class="option yesmaybe"></th>
                        <th class="option nomaybe"></th>
                        <th class="option no"></th>
                    </tr>
                </thead>
                <tbody id="dabody"></tbody>
            </table>
        </div>
    </div>
</div>
<script>


    var dates = {
        '2013-12-06': [100,0,0,0],
        '2013-11-02': [75,5,0,20],
        '2013-12-24 13:00': [30, 40, 10, 10],
        '2013-12-24 15:00': [10, 10, 0, 80],
        '2013-11-01': [40,50,8,2],
        '2013-12-25 13:00': [7, 42, 30, 10],
        '2013-12-25 15:00': [0, 0, 90, 20],
        '2013-12-25 9:00': [50, 0, 0, 50]
    }
    for (var dtm in dates) {
        var row = $("<tr/>");
        var th = $("<th></th>");
        var date = dtm;
        var dow = getDow(date);
        th.text(dow + " " + date);
        var total = 0;
        for (var result in dates[dtm]) {
            total += dates[dtm][result];
        }
        row.append(th);
        for (var result in dates[dtm]) {
            var td = $("<td></td>")
            var value = dates[dtm][result];
            var percentage = value / total;
            var size = 16 + Math.floor(percentage * 10);
            var color = 255 - Math.min(255, Math.floor(75 + 150 * percentage));
            td.css({'font-size' : size, 'color': 'rgb('+color+','+color+','+color+')' });
            td.text(value);
            row.append(td);
        }
        $("#dabody").append(row);
    }

    $("#results").tablesorter({sortList: [[1,1], [2,1], [3,1]]});

    function getDow(dtm) {
        return ["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][new Date(Date.parse(dtm)).getDay()];
    }


</script>
</body>
</html>